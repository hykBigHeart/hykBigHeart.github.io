(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61672c49"],{"0683":function(e,t,i){e.exports=i.p+"img/img.f335936e.svg"},"0d15":function(e,t,i){e.exports=i.p+"img/extraUrgent.77af812b.svg"},"17e9":function(e,t,i){"use strict";i("d182")},"307e":function(e,t,i){e.exports=i.p+"img/add.c237168b.svg"},3167:function(e,t,i){e.exports=i.p+"img/deleteSvg.b19a4cd1.svg"},"38ce":function(e,t,i){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"mobile-title"},[t("navBar",{attrs:{titleText:e.titleText,svgIcon:e.close},on:{changeClose:e.changeClose}})],1),"问题处理"==e.titleText?t("div",[t("div",{staticClass:"mobile-body"},[t("van-cell",{attrs:{center:"",title:"承包商处理人",label:this.userName?this.userName:"无"}}),t("div",{staticClass:"item"},[e._m(0),t("div",{staticClass:"time-frame"},[t("img",{attrs:{src:e.date}}),t("span",[e._v(e._s((new Date).toLocaleDateString().replace(/\//g,"-")))])])]),t("div",{staticClass:"item"},[t("p",[e._v("问题图片")]),e._l(e.problemImg,(function(i){return t("div",{key:i.id,staticClass:"img-frame",staticStyle:{margin:"0.5rem 0rem"},on:{click:function(t){return e.showImg(i.imgPath)}}},[t("img",{attrs:{src:e.img}}),t("span",[e._v(e._s(i.imgName))])])})),t("van-uploader",{ref:"vanUploader",staticStyle:{display:"none"},attrs:{"show-upload":!0,"after-read":e.afterRead}}),t("img",{attrs:{src:e.add_img},on:{click:function(t){return e.$refs.vanUploader.chooseFile()}}})],2),t("div",{staticClass:"item",staticStyle:{"margin-top":"2.625rem"}},[t("p",[e._v("转发 ")]),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.forwardTitle,options:e.forward},on:{change:e.handelChange},model:{value:e.forwardValue,callback:function(t){e.forwardValue=t},expression:"forwardValue"}})],1)],1)],1),t("van-popup",{staticClass:"time-popup",style:{width:"70%"},attrs:{round:""},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t("h3",[e._v("选择时间")]),t("p",{staticStyle:{"text-align":"center"}},[t("span",{on:{click:function(t){return e.changeTimeType("date")}}},[e._v(e._s(e.curDateText))]),e._v(" "),t("span",{on:{click:function(t){return e.changeTimeType("time")}}},[e._v(e._s(e.curTimeText))])]),t("van-datetime-picker",{attrs:{type:e.timeType},on:{confirm:e.confirm,cancel:e.cancel,change:e.timeChange},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1)],1):t("div",[t("div",{staticClass:"mobile-body"},[t("van-cell",{attrs:{center:"",title:"验证人",label:this.userName?this.userName:"无"}}),t("div",{staticClass:"item"},[e._m(1),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.completionTitle,options:e.completion},on:{change:e.completionChange},model:{value:e.completionValue,callback:function(t){e.completionValue=t},expression:"completionValue"}})],1)],1),t("div",{staticClass:"item"},[t("p",[e._v("问题验证时间")]),t("div",{staticClass:"time-frame"},[t("img",{attrs:{src:e.date}}),t("span",[e._v(e._s((new Date).toLocaleDateString().replace(/\//g,"-")))])])]),t("div",{staticClass:"item"},[t("p",[e._v("验证意见")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],attrs:{cols:"30",rows:"5",placeholder:"请输入"},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value)}}})])],1)]),t("van-button",{staticClass:"float-button",attrs:{round:"",type:"info",block:""},on:{click:e.submit}},[e._v("提交")])],1)},s=[function(){var e=this,t=e._self._c;return t("p",[e._v("问题整改完成时间 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("完成情况 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])}],a=(i("b7ef"),i("907a"),i("3c5d"),i("fa9e"),i("77d9"),i("da1d")),r=i("28a2"),n={name:"ProblemMangeHandling",components:{navBar:a["a"]},data(){return{titleText:"",show:!1,currentDate:null,timeType:"date",showTime:"请选择时间",curDateText:"",curTimeText:"",overTime:"",problemImg:[],pictureId:[],forwardValue:"",forwardTitle:"",forward:[],userName:"",problemList:[],justProblem:[],close:i("bf37"),date:i("8a32"),img:i("0683"),add_img:i("81a9"),questionId:"",justType:"",completion:[{text:"合格",value:0},{text:"不合格",value:1}],completionTitle:"",completionValue:"",description:""}},methods:{afterRead(e){function t(e,t){let i=e.split(","),o=i[0].match(/:(.*?);/)[1],s=atob(i[1]),a=s.length,r=new Uint8Array(a);while(a--)r[a]=s.charCodeAt(a);return new File([r],t,{type:o})}console.log("afterRead",e);const i=new FormData;i.append("uploadFile",t(e.content,e.file.name)),console.log("fromData",i),this.$postHttp(this.$baseUrl+"/CMS/file/upload",i).then(e=>{console.log("upload",e),200==e.status&&(this.pictureId.push(e.data.data.id),this.problemImg.push({imgName:e.data.data.fileName+"."+e.data.data.fileType,imgPath:e.data.data.filePath,id:e.data.data.id}))}).catch(e=>{})},changeClose(){this.reset(),this.$emit("changeCloseHandling")},handleTime(){this.show=!0,this.timeType="date",this.getCurTime(new Date)},showImg(e){Object(r["a"])([e])},handelChange(e){this.forward.forEach(t=>{t.value===e&&(this.forwardTitle=t.text)})},completionChange(e){this.completion.forEach(t=>{t.value===e&&(this.completionTitle=t.text)})},confirm(e){this.show=!1,this.getCurTime(e,!0)},cancel(e){this.show=!1},timeChange(e,t,i){if("time"==this.timeType){let t=e.getValues();this.curTimeText=t[0]+":"+t[1]+this.curTimeText.slice(5),this.overTime=this.overTime.slice(0,11)+t[0]+":"+t[1]}},changeTimeType(e){"time"==e&&this.getCurTime(this.currentDate,!0),this.timeType=e},submit(){if("问题处理"==this.titleText)this.$getHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/personCommit",{params:{questionId:this.questionId,type:this.justType,personId:this.forwardValue,fileId:this.pictureId?this.pictureId.toString():"",name:this.forwardTitle,overTime:(new Date).toLocaleDateString().replace(/\//g,"-")}}).then(e=>{console.log("personCommit",e),200==e.status&&this.$emit("changeCloseHandling",!0)});else{if(""==this.completionTitle)return void alert("请选择完成情况");this.$getHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/questionValidate",{params:{questionId:this.questionId,state:"合格"==this.completionTitle?"COMMIT":"SAVE",comment:this.description}}).then(e=>{console.log("questionValidate",e),200==e.status&&this.$emit("changeCloseHandling")})}},getCurTime(e,t){let i,o,s;"time"==this.timeType?this.curTimeText=e+this.curTimeText.slice(5):(i=e.toLocaleDateString().split("/")[0],o=e.toLocaleDateString().split("/")[1]-1,s=e.toLocaleDateString().split("/")[2],t||(this.overTime=e.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")),this.curDateText=i+"年"+(o+1)+"月"+s+"日",this.curTimeText=this.overTime.split(" ")[1]),t&&(this.showTime=this.curDateText+" "+this.curTimeText),this.currentDate=new Date(i,o,s)},async getUserName(){const e=await this.$getHttp(this.$baseUrl+"/CMS/uams/getUserInfo");console.log("getUserInfonb1",e),200==e.status&&(this.userName=e.data.name,console.log("this.userName",this.userName))},getCurProblem(e){let t="";this.$postHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/getQuestion",{id:e}).then(e=>{console.log("获取当前这条问题的信息",e,"当前用户",this.userName),200==e.data.code&&(e.data.data.question[0].conperson==this.userName?(t=e.data.data.question[0].contractor,this.justType="con"):e.data.data.question[0].supPerson==this.userName?(t=e.data.data.question[0].supervisory_unit,this.justType="sup"):(t=e.data.data.question[0].territorial_unit,this.justType="ter"),this.getPeople(t))})},getProblemList(e){this.problemList=[],this.justProblem=[];let t="";this.$postHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/getQuestion",{}).then(i=>{console.log("getQuestion",i),200==i.data.code&&(this.problemList=i.data.data.question,console.log("this.problemList",this.problemList),console.log("problemList",e),this.justProblem=this.problemList.filter(t=>!e.some(e=>e.id===t.id)),console.log("justProblem",this.justProblem),this.$postHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/getQuestion",{id:this.justProblem[0].id}).then(e=>{console.log("获取当前这条问题的信息",e),200==e.data.code&&(e.data.data.question[0].conperson==this.userName?(t=e.data.data.question[0].contractor,this.justType="con"):e.data.data.question[0].supPerson==this.userName?(t=e.data.data.question[0].supervisory_unit,this.justType="sup"):(t=e.data.data.question[0].territorial_unit,this.justType="ter"),this.getPeople(t))}))}).catch(e=>{})},getPeople(e){this.forward=[],this.$getHttp(`${this.$baseUrl}/OS-PM/organization/findUserByOrgName/${e}`).then(e=>{console.log("findUserByOrgName",e),200==e.status&&e.data.forEach(e=>{const t={text:e.userName,value:e.id};this.forward.push(t)})}).catch(e=>{})},async init(e,t){this.titleText=1==t?"问题处理":"问题验证",this.questionId=e,await this.getUserName(),this.getCurProblem(e)},reset(){this.userName="",this.pictureId=[],this.problemImg=[],this.forward=[],this.forwardTitle="",this.forwardValue="",this.completion=[],this.completionTitle="",this.completionValue="",this.description=""}},mounted(){}},l=n,c=(i("8614"),i("2877")),u=Object(c["a"])(l,o,s,!1,null,"bfae71c4",null);t["a"]=u.exports},"398a":function(e,t,i){"use strict";i("446a")},"446a":function(e,t,i){},"49bb":function(e,t,i){"use strict";i("ea14")},"4d5e":function(e,t,i){e.exports=i.p+"img/screen.bf936d8a.svg"},"6bf6":function(e,t,i){e.exports=i.p+"img/commonly.61c007c3.svg"},"6da5":function(e,t,i){e.exports=i.p+"img/urgent.58447e3b.svg"},"81a9":function(e,t,i){e.exports=i.p+"img/add_img.ca323127.svg"},8614:function(e,t,i){"use strict";i("9c64")},"87f8":function(e,t,i){e.exports=i.p+"img/screen_select.c2afc525.svg"},"8a32":function(e,t,i){e.exports=i.p+"img/date.6d33281b.svg"},"9c64":function(e,t,i){},bf37:function(e,t,i){e.exports=i.p+"img/close.e7685cae.svg"},c917:function(e,t,i){e.exports=i.p+"img/right.dc99d06c.svg"},d182:function(e,t,i){},dacc:function(e,t,i){e.exports=i.p+"img/save.58b1c209.svg"},dd06:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"problem-mange-index"},[t("div",{staticClass:"title"},[t("navBar",{attrs:{titleText:"问题管理",svgIconRight:e.screenSvg},on:{clickRight:e.showScreen}})],1),t("div",{staticClass:"problem-mange-body"},[0!=e.draftList.length?t("div",e._l(e.draftList,(function(i){return t("div",{key:i.id,staticClass:"draft-item",on:{click:function(t){return e.continueEditing(i)}}},[t("p",[e._v(e._s(i.agreementName?i.agreementName:"问题标题"))]),t("span",{staticClass:"draft",on:{click:e.clickCg}},[e._v("草稿")])])})),0):e._e(),0!=e.problemList.length?t("div",e._l(e.problemList,(function(i){return t("div",{key:i.id,staticClass:"problem-mange-item",on:{click:function(t){return e.toProblemMangeDetails(i)}}},[t("img",{attrs:{src:e.extraUrgent}}),t("h3",[e._v(e._s(i.agreementName))]),t("p",[t("span",{style:"已解决"==i.Mstate?"color: #02CD53":"待验证"==i.Mstate?"color: #9133EF":"待处理"==i.Mstate?"color: #00A3FF":""},[e._v(e._s(i.Mstate))]),e._v(" "+e._s(i.unit))]),t("p",[t("span",{staticStyle:{color:"#B4B4B4"}},[e._v("解决期限：")]),e._v(" "+e._s(i.overTime))])])})),0):t("van-empty",{staticClass:"custom-image",attrs:{image:i("ea61"),description:"无问题项"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],staticClass:"float-button"},[t("van-button",{attrs:{type:"info"},on:{click:e.showAdd}},[t("img",{attrs:{src:e.add}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!e.btnTextVisible,expression:"!btnTextVisible"}]},[e._v("新增问题")])])],1),t("van-popup",{style:{height:"100%"},attrs:{position:"bottom",duration:"0"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t("problemManageScreen",{on:{changeClose:e.changeClose}})],1),t("van-popup",{style:{height:"100%"},attrs:{position:"bottom",duration:"0"},model:{value:e.addShow,callback:function(t){e.addShow=t},expression:"addShow"}},[t("problemManageAdd",{ref:"problemManageAdd",on:{changeClose:e.changeClose}})],1)],1)},s=[],a=i("da1d"),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"problem-mange-screen"},[t("div",{staticClass:"title"},[t("navBar",{attrs:{titleText:"问题筛选",svgIcon:e.close},on:{changeClose:e.changeClose}})],1),t("div",{staticClass:"problem-mange-body"},[t("van-form",[t("p",[e._v("承包商名称")]),t("van-field",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.contractorName,callback:function(t){e.contractorName=t},expression:"contractorName"}}),t("p",[e._v("属地单位")]),t("van-field",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.unit,callback:function(t){e.unit=t},expression:"unit"}}),t("p",[e._v("问题专业")]),t("div",e._l(e.questionOptions,(function(i){return t("van-button",{key:i.sub,attrs:{plain:"",type:e.curQuestion==i.sub?"info":"default"},on:{click:function(t){return e.clickQuestion(i)}}},[e._v(e._s(i.val))])})),1),t("p",{staticStyle:{"margin-top":"1rem"}},[e._v("状态")]),t("div",e._l(e.stateOptions,(function(i){return t("van-button",{key:i.sub,attrs:{plain:"",type:e.curState==i.sub?"info":"default"},on:{click:function(t){return e.clickState(i)}}},[e._v(e._s(i.val))])})),1)],1)],1),e.btnVisible?t("div",{staticClass:"float-button"},[t("span",{on:{click:e.resetAll}},[e._v("清除全部")]),t("van-button",{attrs:{type:"info"},on:{click:e.ok}},[t("span",{directives:[{name:"show",rawName:"v-show",value:!e.btnTextVisible,expression:"!btnTextVisible"}]},[e._v("确定")])])],1):e._e()])},n=[],l={name:"ProblemMangeScreen",components:{navBar:a["a"]},data(){return{contractorName:"",unit:"",btnVisible:!0,btnTextVisible:!1,questionOptions:[{val:"全部",sub:0},{val:"动设备",sub:1},{val:"静设备",sub:2},{val:"电气设备",sub:3},{val:"检修",sub:4},{val:"仪表设备",sub:5}],curQuestion:0,stateOptions:[{val:"全部",sub:0},{val:"待处理",sub:1},{val:"待验证",sub:2},{val:"已解决",sub:3}],curState:0,deleteSvg:i("3167"),close:i("bf37")}},watch:{"$store.state.btnShow"(e){console.log("watch",e),this.btnVisible=e}},methods:{changeClose(){this.$emit("changeClose")},clickQuestion(e){this.questionOptions.forEach(t=>{t.sub==e.sub&&(this.curQuestion=e.sub)})},clickState(e){this.stateOptions.forEach(t=>{t.sub==e.sub&&(this.curState=e.sub)})},resetAll(){this.contractorName="",this.unit="",this.curQuestion=0,this.curState=0},ok(){this.$emit("changeClose",{contractorName:this.contractorName,territorialUnit:this.unit,questionMajor:"全部"==this.questionOptions[this.curQuestion].val?"":this.questionOptions[this.curQuestion].val,state:"全部"==this.stateOptions[this.curState].val?"":"待处理"==this.stateOptions[this.curState].val?"EDIT":"待验证"==this.stateOptions[this.curState].val?"SAVE":"已解决"==this.stateOptions[this.curState].val?"COMMIT":""})}},mounted(){let e=null;window.addEventListener("scroll",()=>{this.btnTextVisible=!0,window.clearTimeout(e),e=window.setTimeout(()=>{this.btnTextVisible=!1},101)})}},c=l,u=(i("49bb"),i("2877")),h=Object(u["a"])(c,r,n,!1,null,"c3a3ff78",null),p=h.exports,d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"mobile-title"},[t("navBar",{attrs:{titleText:"新建问题",svgIcon:e.close},on:{changeClose:e.changeClose}})],1),t("div",{staticClass:"mobile-body"},[e._m(0),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.contractNameTitle,options:e.contractName},on:{open:function(t){return e.handelOpen("合同名称")},change:e.handelChange},model:{value:e.contractNameValue,callback:function(t){e.contractNameValue=t},expression:"contractNameValue"}})],1),t("p",[e._v("合同编号")]),t("div",[e._v(e._s(e.contractCode?e.contractCode:"-"))]),e._m(1),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.serviceTypeTitle,options:e.serviceType,disabled:""},on:{open:function(t){return e.handelOpen("服务类型")},change:e.handelChange},model:{value:e.serviceTypeValue,callback:function(t){e.serviceTypeValue=t},expression:"serviceTypeValue"}})],1),e._m(2),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.problemOneTitle,options:e.problemOne},on:{open:function(t){return e.handelOpen("问题类型一")},change:e.handelChange},model:{value:e.problemOneValue,callback:function(t){e.problemOneValue=t},expression:"problemOneValue"}})],1),e._m(3),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.problemTwoTitle,options:e.problemTwo},on:{open:function(t){return e.handelOpen("问题类型二")},change:e.handelChange},model:{value:e.problemTwoValue,callback:function(t){e.problemTwoValue=t},expression:"problemTwoValue"}})],1),t("p",[e._v("详细说明 "),t("span",{directives:[{name:"show",rawName:"v-show",value:"其他"==e.problemTwoTitle,expression:"problemTwoTitle == '其他'"}],staticStyle:{color:"#f20909"}},[e._v("*")])]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.detailedDes,expression:"detailedDes",modifiers:{trim:!0}}],attrs:{cols:"30",rows:"5",placeholder:"请输入",disabled:"其他"!=e.problemTwoTitle},domProps:{value:e.detailedDes},on:{input:function(t){t.target.composing||(e.detailedDes=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._m(4),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.violationRulesTitle,options:e.violationRules},on:{open:function(t){return e.handelOpen("违反条例")},change:e.handelChange},model:{value:e.violationRulesValue,callback:function(t){e.violationRulesValue=t},expression:"violationRulesValue"}})],1),e._m(5),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.violationDocuments,options:e.processOption,disabled:""},on:{change:e.handelChange},model:{value:e.violationDocuments,callback:function(t){e.violationDocuments=t},expression:"violationDocuments"}})],1),t("p",[e._v("问题大小分类")]),t("div",[e._v(e._s(e.problemSizeClassification?e.problemSizeClassification:"-"))]),t("p",[e._v("赋予分值")]),t("div",[e._v(e._s(e.giveScore?e.giveScore:"-"))]),t("p",[e._v("检查单位")]),t("div",[e._v(e._s("{}"!=JSON.stringify(e.userInfo)?e.userInfo.userGroups[0].name:"-"))]),t("p",[e._v("检查人")]),t("div",[e._v(e._s("{}"!=JSON.stringify(e.userInfo)?e.userInfo.name:"-"))]),e._m(6),t("div",{staticClass:"time-frame",on:{click:e.handleTime}},[t("img",{attrs:{src:e.date}}),t("span",[e._v(e._s(e.curTimeText))])]),t("p",[e._v("项目名称")]),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.projectNameTitle,options:e.projectName},on:{open:function(t){return e.handelOpen("项目名称")},change:e.handelChange},model:{value:e.projectNameValue,callback:function(t){e.projectNameValue=t},expression:"projectNameValue"}})],1),t("p",[e._v("项目编码")]),t("div",[e._v(e._s(e.projectCode?e.projectCode:"-"))]),e._m(7),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.supervisorUnitTitle,options:e.supervisorUnit},on:{open:function(t){return e.handelOpen("监理单位")},change:e.handelChange},model:{value:e.supervisorUnitValue,callback:function(t){e.supervisorUnitValue=t},expression:"supervisorUnitValue"}})],1),e._m(8),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.contractor,options:e.processOption,disabled:""},on:{change:e.handelChange},model:{value:e.contractor,callback:function(t){e.contractor=t},expression:"contractor"}})],1),e._m(9),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.territorialUnitTitle,options:e.territorialUnit},on:{open:function(t){return e.handelOpen("属地单位")},change:e.handelChange},model:{value:e.territorialUnitValue,callback:function(t){e.territorialUnitValue=t},expression:"territorialUnitValue"}})],1),e._m(10),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.problemSpecialtyTitle,options:e.problemSpecialty},on:{open:function(t){return e.handelOpen("问题专业")},change:e.handelChange},model:{value:e.problemSpecialtyValue,callback:function(t){e.problemSpecialtyValue=t},expression:"problemSpecialtyValue"}})],1),t("p",[e._v("问题图片")]),e._l(e.problemImg,(function(i){return t("div",{key:i.id,staticClass:"img-frame",staticStyle:{margin:"0.5rem 0rem"},on:{click:function(t){return e.showImg(i.imgPath)}}},[t("img",{attrs:{src:e.img}}),t("span",[e._v(e._s(i.imgName))])])})),t("van-uploader",{ref:"vanUploader",staticStyle:{display:"none"},attrs:{"show-upload":!0,"after-read":e.afterRead}}),t("img",{attrs:{src:e.add_img},on:{click:function(t){return e.$refs.vanUploader.chooseFile()}}}),e._m(11),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],attrs:{cols:"30",rows:"5",placeholder:"请输入"},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value)}}}),e._m(12),t("van-field",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.aBoss,callback:function(t){e.aBoss=t},expression:"aBoss"}}),e._m(13),t("van-field",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.aGuardian,callback:function(t){e.aGuardian=t},expression:"aGuardian"}}),e._m(14),t("van-field",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.bBoss,callback:function(t){e.bBoss=t},expression:"bBoss"}}),e._m(15),t("van-field",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.bGuardian,callback:function(t){e.bGuardian=t},expression:"bGuardian"}}),e._m(16),e._l(e.dutyOptions,(function(i,o){return t("van-button",{key:o,attrs:{plain:"",type:i.sub?"info":"default"},on:{click:function(t){return e.clickDuty(i,o)}}},[e._v(e._s(i.val))])})),t("div",{directives:[{name:"show",rawName:"v-show",value:e.dutyOptions[0].sub,expression:"dutyOptions[0].sub"}]},[e._m(17),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.contractorDutyTitle},on:{open:function(t){return e.handelOpen("承包商责任")},change:e.handelChange,close:function(t){return e.handleClose("承包商责任")}},model:{value:e.contractorDutyValue,callback:function(t){e.contractorDutyValue=t},expression:"contractorDutyValue"}},[t("div",{staticClass:"check-box"},[t("van-checkbox-group",{model:{value:e.contractorDutyResult,callback:function(t){e.contractorDutyResult=t},expression:"contractorDutyResult"}},[t("van-cell-group",e._l(e.contractorDuty,(function(i,o){return t("van-cell",{key:o,attrs:{clickable:"",title:""+i.text},on:{click:function(t){return e.toggle(i.value,o,"承包商责任")}},scopedSlots:e._u([{key:"right-icon",fn:function(){return[t("van-checkbox",{ref:"contractorDutyCheckboxes",refInFor:!0,attrs:{name:i.value}})]},proxy:!0}],null,!0)})})),1)],1)],1)])],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.dutyOptions[1].sub,expression:"dutyOptions[1].sub"}]},[e._m(18),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.supervisorUnitDutyTitle},on:{open:function(t){return e.handelOpen("监理单位责任")},change:e.handelChange,close:function(t){return e.handleClose("监理单位责任")}},model:{value:e.supervisorUnitDutyValue,callback:function(t){e.supervisorUnitDutyValue=t},expression:"supervisorUnitDutyValue"}},[t("div",{staticClass:"check-box"},[t("van-checkbox-group",{model:{value:e.supervisorUnitDutyResult,callback:function(t){e.supervisorUnitDutyResult=t},expression:"supervisorUnitDutyResult"}},[t("van-cell-group",e._l(e.supervisorUnitDuty,(function(i,o){return t("van-cell",{key:o,attrs:{clickable:"",title:""+i.text},on:{click:function(t){return e.toggle(i.value,o,"监理单位责任")}},scopedSlots:e._u([{key:"right-icon",fn:function(){return[t("van-checkbox",{ref:"supervisorUnitDutyCheckboxes",refInFor:!0,attrs:{name:i.text}})]},proxy:!0}],null,!0)})})),1)],1)],1)])],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.dutyOptions[2].sub,expression:"dutyOptions[2].sub"}]},[e._m(19),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.territoryUnitDutyTitle},on:{open:function(t){return e.handelOpen("属地单位责任")},change:e.handelChange,close:function(t){return e.handleClose("属地单位责任")}},model:{value:e.territoryUnitDutyValue,callback:function(t){e.territoryUnitDutyValue=t},expression:"territoryUnitDutyValue"}},[t("div",{staticClass:"check-box"},[t("van-checkbox-group",{model:{value:e.territoryUnitDutyResult,callback:function(t){e.territoryUnitDutyResult=t},expression:"territoryUnitDutyResult"}},[t("van-cell-group",e._l(e.territoryUnitDuty,(function(i,o){return t("van-cell",{key:o,attrs:{clickable:"",title:""+i.text},on:{click:function(t){return e.toggle(i.value,o,"属地单位责任")}},scopedSlots:e._u([{key:"right-icon",fn:function(){return[t("van-checkbox",{ref:"territoryUnitDutyCheckboxes",refInFor:!0,attrs:{name:i.text}})]},proxy:!0}],null,!0)})})),1)],1)],1)])],1)],1),t("p",[e._v("扣分")]),t("div",[e._v(e._s(e.deductPoints&&"NaN"!=e.deductPoints?e.deductPoints:"-"))]),t("p",[e._v("要求完成时间")]),t("div",{staticClass:"time-frame",on:{click:function(t){return e.handleTime("要求完成时间")}}},[t("img",{attrs:{src:e.date}}),t("span",[e._v(e._s(e.requiredTime))])]),t("p",[e._v("考核金额")]),t("van-field",{attrs:{placeholder:"请输入金额",clearable:""},model:{value:e.money,callback:function(t){e.money=t},expression:"money"}}),e._m(20),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.completedOnSiteTitle,options:e.completedOnSite},on:{open:function(t){return e.handelOpen("是否现场完成")},change:e.handelChange},model:{value:e.completedOnSiteValue,callback:function(t){e.completedOnSiteValue=t},expression:"completedOnSiteValue"}})],1),e._m(21),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.violatesTheSixTitle,options:e.violatesTheSix},on:{open:function(t){return e.handelOpen("是否违反六大禁令")},change:e.handelChange},model:{value:e.violatesTheSixValue,callback:function(t){e.violatesTheSixValue=t},expression:"violatesTheSixValue"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"是"==e.violatesTheSixTitle,expression:"violatesTheSixTitle == '是'"}]},[e._m(22),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.selectViolatesTheSixTitle,options:[]},on:{open:function(t){return e.handelOpen("选择是否违反六大禁令")},change:e.handelChange},model:{value:e.selectViolatesTheSixValue,callback:function(t){e.selectViolatesTheSixValue=t},expression:"selectViolatesTheSixValue"}})],1)],1),e._m(23),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.employeesUnsafeTitle,options:e.employeesUnsafe},on:{open:function(t){return e.handelOpen("是否违反员工不安全行为")},change:e.handelChange},model:{value:e.employeesUnsafeValue,callback:function(t){e.employeesUnsafeValue=t},expression:"employeesUnsafeValue"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"是"==e.employeesUnsafeTitle,expression:"employeesUnsafeTitle == '是'"}]},[e._m(24),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.selectEmployeesUnsafeTitle,options:[]},on:{open:function(t){return e.handelOpen("选择是否违反员工不安全行为")},change:e.handelChange},model:{value:e.selectEmployeesUnsafeValue,callback:function(t){e.selectEmployeesUnsafeValue=t},expression:"selectEmployeesUnsafeValue"}})],1)],1),e._m(25),t("van-dropdown-menu",{attrs:{"get-container":"body",direction:"up"}},[t("van-dropdown-item",{attrs:{title:e.contractorEmployeesUnsafeTitle,options:e.contractorEmployeesUnsafe},on:{open:function(t){return e.handelOpen("是否违反承包商人员不安全行为")},change:e.handelChange},model:{value:e.contractorEmployeesUnsafeValue,callback:function(t){e.contractorEmployeesUnsafeValue=t},expression:"contractorEmployeesUnsafeValue"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"是"==e.contractorEmployeesUnsafeTitle,expression:"contractorEmployeesUnsafeTitle == '是'"}]},[e._m(26),t("van-dropdown-menu",{attrs:{"get-container":"body"}},[t("van-dropdown-item",{attrs:{title:e.selectContractorEmployeesUnsafeTitle,options:[]},on:{open:function(t){return e.handelOpen("选择是否违反承包商人员不安全行为")},change:e.handelChange},model:{value:e.selectContractorEmployeesUnsafeValue,callback:function(t){e.selectContractorEmployeesUnsafeValue=t},expression:"selectContractorEmployeesUnsafeValue"}})],1)],1)],2),t("van-popup",{staticClass:"time-popup",style:{width:"70%"},attrs:{round:""},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t("h3",[e._v("选择时间")]),e.isRequiredTimePopup?t("p",{staticStyle:{"text-align":"center"},on:{click:e.handleTimeType}},[e._v(e._s(e.requiredTime))]):t("p",{staticStyle:{"text-align":"center"}},[e._v(e._s(e.curTimeText))]),t("van-datetime-picker",{attrs:{type:e.timeType},on:{confirm:e.confirm,cancel:e.cancel},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1),t("van-popup",{staticClass:"upload-popup",style:{height:"25.5%"},attrs:{position:"bottom"},model:{value:e.showUpload,callback:function(t){e.showUpload=t},expression:"showUpload"}},e._l(e.btnList,(function(i,o){return t("van-cell",{key:o,attrs:{"is-link":"",center:"",title:i,label:""},on:{click:function(t){return e.handelBtn(i)}}})})),1),t("transition",{attrs:{name:"van-slide-up"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"tips-box"},[t("span",[e._v("至少选择一名责任方")]),t("span"),t("span",{on:{click:function(t){e.visible=!1}}},[e._v("确定")])])]),t("van-popup",{style:{height:"100%"},attrs:{position:"bottom"},model:{value:e.banActionShow,callback:function(t){e.banActionShow=t},expression:"banActionShow"}},[t("navBar",{attrs:{titleText:"",svgIcon:e.close,svgIconRight:e.right},on:{changeClose:e.changeBanActionShow,clickRight:e.clickRight}}),"选择是否违反六大禁令"==this.curDropDown?t("p",{staticClass:"tips-text"},[e._v("中石油六大禁令")]):"选择是否违反员工不安全行为"==this.curDropDown?t("p",{staticClass:"tips-text"},[e._v("员工行为安全规范治理清单")]):t("p",{staticClass:"tips-text"},[e._v("承包商人员不规范安全行为清单")]),t("div",{staticClass:"ban-action-box"},[t("van-radio-group",{model:{value:e.banActionRadio,callback:function(t){e.banActionRadio=t},expression:"banActionRadio"}},[e._l(e.banActionList,(function(i){return[t("van-radio",{key:i.id,attrs:{name:i.id},on:{click:function(t){return e.clickRadio(i)}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:"ban"==i.type,expression:"item.type == 'ban'"}],staticClass:"item"},[t("p",[e._v(e._s(i.ban_content))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:"person"==i.type,expression:"item.type == 'person'"}],staticClass:"item"},[t("p",[e._v(e._s(i.person_behavior_no)+" "+e._s(i.person_behavior))]),t("span",[e._v(e._s(i.person_department))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:"cperson"==i.type,expression:"item.type == 'cperson'"}],staticClass:"item"},[t("p",[e._v(e._s(i.cperson_category)+" "+e._s(i.cperson_behavior))]),t("span",[e._v(e._s(i.cperson_major))])])])]}))],2)],1)],1),t("van-popup",{style:{height:"100%"},attrs:{position:"bottom"},model:{value:e.handlingShow,callback:function(t){e.handlingShow=t},expression:"handlingShow"}},[t("problemHandling",{ref:"problemHandling",on:{changeCloseHandling:e.changeCloseHandling}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.visible,expression:"!visible"}],staticClass:"float-button"},[t("van-button",{attrs:{round:"",plain:"",type:"info"},on:{click:e.clickSave}},[e._v("保存")]),t("van-button",{attrs:{round:"",type:"info"},on:{click:function(t){return e.submit("COMMIT")}}},[e._v("提交")])],1)],1)},m=[function(){var e=this,t=e._self._c;return t("p",[e._v("合同名称 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("服务类型 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("问题类型一 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("问题类型二 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("违反条例 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("违反文件 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("检查日期 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("监理单位 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("承包商 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("属地单位 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("问题专业 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("问题描述 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("甲方项目负责人 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("甲方监护人 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("乙方项目负责人 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("乙方监护人 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("责任方 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("承包商责任 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("监理单位责任 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("属地单位责任 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("是否现场完成 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[e._v("是否违反六大禁令 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[t("span",{staticStyle:{color:"#f20909"}})])},function(){var e=this,t=e._self._c;return t("p",[e._v("是否违反员工不安全行为 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[t("span",{staticStyle:{color:"#f20909"}})])},function(){var e=this,t=e._self._c;return t("p",[e._v("是否违反承包商人员不安全行为 "),t("span",{staticStyle:{color:"#f20909"}},[e._v("*")])])},function(){var e=this,t=e._self._c;return t("p",[t("span",{staticStyle:{color:"#f20909"}})])}],v=(i("b7ef"),i("907a"),i("3c5d"),i("fa9e"),i("77d9"),i("caad"),i("38ce")),g=i("28a2"),b={name:"ProblemMangeAdd",components:{navBar:a["a"],problemHandling:v["a"]},computed:{deductPoints(){let e=this.dutyOptions.filter(e=>e.sub).length;return Number.isInteger(this.giveScore/e)?this.giveScore/e:(this.giveScore/e).toFixed(2)}},data(){return{show:!1,showUpload:!1,visible:!1,banActionShow:!1,handlingShow:!1,userInfo:{},processValue:"",processTitle:"请选择",processOption:[],description:"",aBoss:"",aGuardian:"",bBoss:"",bGuardian:"",money:"",contractorName:"",dutyOptions:[{val:"承包商",sub:0},{val:"监理单位",sub:0},{val:"属地单位",sub:0}],minDate:new Date(2020,0,1),maxDate:new Date(2025,10,1),currentDate:new Date,timeType:"date",curTimeText:"",isRequiredTimePopup:!1,requiredTime:"",checkTime:"",overTime:"",pictureId:[],btnList:["拍照","从相册上传","取消"],curDropDown:"",contractCode:"",contractor:"",violationDocuments:"",problemSizeClassification:"",giveScore:"1",projectCode:"",contractNameValue:"",contractNameTitle:"",contractName:[],serviceTypeValue:"",serviceTypeTitle:"",serviceType:[],problemOneValue:"",problemOneTitle:"",problemOne:[],problemTwoValue:"",problemTwoTitle:"",problemTwo:[],detailedDes:"",violationRulesValue:"",violationRulesTitle:"",violationRules:[],territorialUnitValue:"",territorialUnitTitle:"",territorialUnit:[],projectNameValue:"",projectNameTitle:"",projectName:[],supervisorUnitValue:"",supervisorUnitTitle:"",supervisorUnit:[{text:"北京华油鑫业工程技术有限公司",value:0},{text:"新疆寰球",value:1},{text:"不涉及",value:2}],problemClassValue:"",problemClassTitle:"",problemClass:[{text:"安全",value:0},{text:"质量",value:1},{text:"进度",value:2},{text:"环保",value:3}],problemSpecialtyValue:"",problemSpecialtyTitle:"",problemSpecialty:[{text:"动设备",value:0},{text:"静设备",value:1},{text:"电气设备",value:2},{text:"检修",value:3},{text:"仪表设备",value:4}],problemImg:[{}],contractorDutyValue:"",contractorDutyTitle:"",contractorDutyResult:[],contractorDutyCheckData:[],contractorDirector:[],contractorDirectorStr:"",contractorDuty:[],supervisorUnitDutyValue:"",supervisorUnitDutyTitle:"",supervisorUnitDutyResult:[],supervisorUnitDutyCheckData:[],supervisoryDirector:[],supervisoryDirectorStr:"",supervisorUnitDuty:[],territoryUnitDutyValue:"",territoryUnitDutyTitle:"",territoryUnitDutyResult:[],territoryUnitDutyCheckData:[],territorialDirector:[],territorialDirectorStr:"",territoryUnitDuty:[],completedOnSiteValue:"",completedOnSiteTitle:"",completedOnSite:[{text:"是",value:0},{text:"否",value:1}],violatesTheSixValue:"",violatesTheSixTitle:"",violatesTheSix:[{text:"是",value:0},{text:"否",value:1}],selectViolatesTheSixValue:"",selectViolatesTheSixTitle:"",employeesUnsafeValue:"",employeesUnsafeTitle:"",employeesUnsafe:[{text:"是",value:0},{text:"否",value:1}],selectEmployeesUnsafeValue:"",selectEmployeesUnsafeTitle:"",contractorEmployeesUnsafeValue:"",contractorEmployeesUnsafeTitle:"",contractorEmployeesUnsafe:[{text:"是",value:0},{text:"否",value:1}],selectContractorEmployeesUnsafeValue:"",selectContractorEmployeesUnsafeTitle:"",banActionRadio:null,banActionList:[],banId:"",personId:"",cpersonId:"",close:i("bf37"),save:i("dacc"),right:i("c917"),date:i("8a32"),img:i("0683"),add_img:i("81a9"),problemList:[],contractorPerson:"",supPerson:"",terPerson:"",contractorEchoPersonID:[],supervisoryEchoPersonID:[],territorialEchoPersonID:[],echoId:""}},methods:{afterRead(e){function t(e,t){console.log("dataurl",e,"filename",t);let i=e.split(","),o=i[0].match(/:(.*?);/)[1],s=atob(i[1]),a=s.length,r=new Uint8Array(a);while(a--)r[a]=s.charCodeAt(a);return new File([r],t,{type:o})}console.log("afterRead",e);const i=new FormData;i.append("uploadFile",t(e.content,e.file.name)),console.log("fromData",i),this.$postHttp(this.$baseUrl+"/CMS/file/upload",i).then(e=>{console.log("upload",e),200==e.status&&(this.pictureId.push(e.data.data.id),this.problemImg.push({imgName:e.data.data.fileName+"."+e.data.data.fileType,imgPath:e.data.data.filePath,id:e.data.data.id}))}).catch(e=>{})},beforeRead(e){console.log("beforeRead",e)},changeClose(){this.reset(),this.$emit("changeClose")},clickSave(){this.submit("NOSUBMIT")},changeBanActionShow(){this.banActionShow=!1},clickRight(){this.banActionShow=!1},clickRadio(e){"ban"==e.type?(this.banId=e.id,this.selectViolatesTheSixTitle=e.ban_content):"person"==e.type?(this.personId=e.id,this.selectEmployeesUnsafeTitle=e.person_behavior):"cperson"==e.type&&(this.cpersonId=e.id,this.selectContractorEmployeesUnsafeTitle=e.cperson_behavior)},changeCloseHandling(e){e&&this.$emit("changeClose"),this.handlingShow=!1},submit(e){this.beforeSubJudge().then(t=>{if(console.log("beforeSubJudge,res",t),!t){console.log("提交了");let t={agreementId:this.contractNameValue?this.contractNameValue:"",agreementName:this.contractNameValue?this.contractNameValue:"",agreementCode:this.contractCode?this.contractCode:"",questionId:this.problemTwoValue?this.problemTwoValue:"",pictureId:this.pictureId?this.pictureId.toString():"",agreementType:this.serviceTypeTitle?this.serviceTypeTitle:"",questionOne:this.problemOneTitle?this.problemOneTitle:"",questionTwo:this.problemTwoValue?this.problemTwoValue:"",categoryComment:this.detailedDes?this.detailedDes:"",safeId:this.violationRulesValue?this.violationRulesValue:"",safeTwo:this.violationDocuments?this.violationDocuments:"",safeThree:this.problemSizeClassification?this.problemSizeClassification:"",safeFour:this.giveScore?this.giveScore:"",checkContractor:this.userInfo.userGroups[0].name?this.userInfo.userGroups[0].name:"",checkUser:this.userInfo.name?this.userInfo.name:"",checkTime:this.checkTime?this.checkTime:"",projectName:this.projectNameTitle?this.projectNameTitle:"",projectCode:this.projectCode?this.projectCode:"",supervisoryUnit:this.supervisorUnitTitle?this.supervisorUnitTitle:"",contractor:this.contractor?this.contractor:"",territorialUnit:this.territorialUnitTitle?this.territorialUnitTitle:"",questionCategory:this.problemClassTitle?this.problemClassTitle:"",questionMajor:this.problemSpecialtyTitle?this.problemSpecialtyTitle:"",questionContent:this.description?this.description:"",aBoss:this.aBoss?this.aBoss:"",aGuardian:this.aGuardian?this.aGuardian:"",bBoss:this.bBoss?this.bBoss:"",bGuardian:this.bGuardian?this.bGuardian:"",contractorDirector:this.contractorDirectorStr?this.contractorDirectorStr:"",supervisoryDirector:this.supervisoryDirectorStr?this.supervisoryDirectorStr:"",territorialDirector:this.territorialDirectorStr?this.territorialDirectorStr:"",koufen:this.deductPoints?this.deductPoints:"",overTime:this.overTime?this.overTime:"",money:this.money?this.money:"",state:e,isFinish:this.completedOnSiteTitle,checkContractorId:this.userInfo.userGroups[0].parentId,banId:this.banId?this.banId:0,personId:this.personId?this.personId:0,cpersonId:this.cpersonId?this.cpersonId:0,contractorPerson:this.contractorPerson,supPerson:this.supPerson,terPerson:this.terPerson,id:this.echoId,saveState:"1"};"COMMIT"==e?delete t.saveState:delete t.id,console.log("parameter",t),this.$postHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/saveQuestion",t).then(e=>{if(console.log("saveQuestion",e),200==e.status)return this.reset(),void this.$emit("changeClose")})}})},async beforeSubJudge(){let e=!1;if(""==this.contractorDutyTitle&&""==this.supervisorUnitDutyTitle&&""==this.territoryUnitDutyTitle)return e=!0,alert("责任方至少选一个人员"),e;if(""==this.contractNameTitle)return e=!0,alert("请选择合同名称"),e;if(""==this.serviceTypeTitle)return e=!0,alert("请选择服务类型"),e;if(""==this.problemOneTitle)return e=!0,alert("请选择问题类型一"),e;if(""==this.problemTwoTitle)return e=!0,alert("请选择问题类型二"),e;if("其他"==this.problemTwoTitle&&!this.detailedDes)return e=!0,alert("请输入详细说明"),e;if(""==this.violationRulesTitle)return e=!0,alert("请选择违反条例"),e;if(""==this.violationDocuments)return e=!0,alert("请选择违反文件"),e;if(""==this.supervisorUnitTitle)return e=!0,alert("请选择监理单位"),e;if(""==this.contractor)return e=!0,alert("请选择承包商"),e;if(""==this.territorialUnitTitle)return e=!0,alert("请选择属地单位"),e;if(""==this.problemSpecialtyTitle)return e=!0,alert("请选择问题专业"),e;if(""==this.description)return e=!0,alert("请选择问题描述"),e;if(""==this.aBoss)return e=!0,alert("请选择甲方项目负责人"),e;if(""==this.aGuardian)return e=!0,alert("请选择甲方监护人"),e;if(""==this.bBoss)return e=!0,alert("请选择乙方项目负责人"),e;if(""==this.bGuardian)return e=!0,alert("请选择乙方监护人"),e;if(""==this.completedOnSiteTitle)return e=!0,alert("请选择是否现场完成"),e;if(""!=this.contractorDutyTitle){const e=await this.$getHttp(`${this.$baseUrl}/OS-PM/organization/findOrgNameByName/${this.contractor}`);console.log("承包商责任",e),e&&e.data.id&&e.data.name&&(this.contractorPerson=`${e.data.id};${e.data.name}`,console.log("contractorPerson",this.contractorPerson))}if(""!=this.supervisorUnitDutyTitle){const e=await this.$getHttp(`${this.$baseUrl}/OS-PM/organization/findOrgNameByName/${this.supervisorUnitTitle}`);console.log("监理单位责任",e),e&&e.data.id&&e.data.name&&(this.supPerson=`${e.data.id};${e.data.name}`,console.log("supPerson",this.supPerson))}if(""!=this.territoryUnitDutyTitle){const e=await this.$getHttp(`${this.$baseUrl}/OS-PM/organization/findOrgNameByName/${this.territorialUnitTitle}`);console.log("属地单位责任",e),e&&e.data.id&&e.data.name&&(this.terPerson=`${e.data.id};${e.data.name}`,console.log("terPerson",this.terPerson))}return console.log("subState",e),await e},toggle(e,t,i){console.log("toggle",e,t,i);let o="",s="",a="",r="",n="",l="";switch(i){case"承包商责任":a="contractorDutyCheckData",r="contractorDirector",n="contractorDirectorStr",o="contractorDuty",s="contractorDutyTitle",l="contractorDutyCheckboxes";break;case"监理单位责任":a="supervisorUnitDutyCheckData",r="supervisoryDirector",n="supervisoryDirectorStr",o="supervisorUnitDuty",s="supervisorUnitDutyTitle",l="supervisorUnitDutyCheckboxes";break;case"属地单位责任":a="territoryUnitDutyCheckData",r="territorialDirector",n="territorialDirectorStr",o="territoryUnitDuty",s="territoryUnitDutyTitle",l="territoryUnitDutyCheckboxes";break;default:break}this.$refs[l][t].toggle();let c=null;this[o].forEach(t=>{t.value==e&&(-1==this[a].indexOf(t.text)?(this[a].push(t.text),this[r].push({text:t.text,value:t.value})):(c=this[a].indexOf(t.text),this[a].splice(c,1),this[r].splice(c,1)),this[a]=Array.from(new Set(this[a])))}),this[n]="",this[r].forEach(e=>{this[n]+=e.value+";"+e.text+","}),this[n]=this[n].slice(0,this[n].length-1),this[s]=this[a].toString()},handelOpen(e){this.curDropDown=e,"选择是否违反六大禁令"!=e&&"选择是否违反员工不安全行为"!=e&&"选择是否违反承包商人员不安全行为"!=e||(this.banActionShow=!0,this.getToolData()),"承包商责任"==e&&this.$nextTick(()=>{this.contractorDuty.filter((e,t)=>{let i=this.contractorEchoPersonID.includes(e.value);i&&this.$refs.contractorDutyCheckboxes[t].toggle()})}),"监理单位责任"==e&&this.$nextTick(()=>{this.supervisorUnitDuty.filter((e,t)=>{let i=this.supervisoryEchoPersonID.includes(e.value);i&&this.$refs.supervisorUnitDutyCheckboxes[t].toggle()})}),"属地单位责任"==e&&this.$nextTick(()=>{this.territoryUnitDuty.filter((e,t)=>{let i=this.territorialEchoPersonID.includes(e.value);i&&this.$refs.territoryUnitDutyCheckboxes[t].toggle()})})},handleClose(e){"承包商责任"==e&&this.$nextTick(()=>{this.contractorDuty.filter((e,t)=>{let i=this.contractorEchoPersonID.includes(e.value);i&&this.$refs.contractorDutyCheckboxes[t].toggle()})}),"监理单位责任"==e&&this.$nextTick(()=>{this.supervisorUnitDuty.filter((e,t)=>{let i=this.supervisoryEchoPersonID.includes(e.value);i&&this.$refs.supervisorUnitDutyCheckboxes[t].toggle()})}),"属地单位责任"==e&&this.$nextTick(()=>{this.territoryUnitDuty.filter((e,t)=>{let i=this.territorialEchoPersonID.includes(e.value);i&&this.$refs.territoryUnitDutyCheckboxes[t].toggle()})})},handelChange(e,t){let i="",o="";switch(this.curDropDown){case"合同名称":i="contractName",o="contractNameTitle";break;case"服务类型":i="serviceType",o="serviceTypeTitle";break;case"问题类型一":i="problemOne",o="problemOneTitle";break;case"问题类型二":i="problemTwo",o="problemTwoTitle";break;case"违反条例":i="violationRules",o="violationRulesTitle";break;case"属地单位":i="territorialUnit",o="territorialUnitTitle";break;case"项目名称":i="projectName",o="projectNameTitle";break;case"监理单位":i="supervisorUnit",o="supervisorUnitTitle";break;case"问题归类":i="problemClass",o="problemClassTitle";break;case"问题专业":i="problemSpecialty",o="problemSpecialtyTitle";break;case"承包商责任":i="contractorDuty",o="contractorDutyTitle";break;case"监理单位责任":i="supervisorUnitDuty",o="supervisorUnitDutyTitle";break;case"属地单位责任":i="territoryUnitDuty",o="territoryUnitDutyTitle";break;case"是否现场完成":i="completedOnSite",o="completedOnSiteTitle";break;case"是否违反六大禁令":i="violatesTheSix",o="violatesTheSixTitle";break;case"是否违反员工不安全行为":i="employeesUnsafe",o="employeesUnsafeTitle";break;case"是否违反承包商人员不安全行为":i="contractorEmployeesUnsafe",o="contractorEmployeesUnsafeTitle";break;default:break}this[i].forEach(t=>{t.value===e&&(this[o]=t.text,"合同名称"==this.curDropDown&&(this.getAllPersons(e),this.contractCode=t.agreementCode,this.contractor=t.contractorName,this.serviceTypeTitle=t.agreementCategoryName),"问题类型一"==this.curDropDown&&(this.problemTwoTitle="",this.problemTwoValue=""),"问题类型二"==this.curDropDown&&t.oneCategory&&(this.problemOneTitle=t.oneCategory,"其他"!=this.problemOneTitle&&(this.detailedDes="")),t.programFileName&&(this.violationDocuments=t.programFileName),t.score&&(this.giveScore=t.score),"违反条例"==this.curDropDown&&(this.problemSizeClassification=t.questionSize),"项目名称"==this.curDropDown&&(this.projectCode=e),"属地单位"==this.curDropDown&&this.getPersonList(t.text),"监理单位"==this.curDropDown&&this.getQuestionManagementPerson(t.text),1==e&&(this.banActionRadio=null,"是否违反六大禁令"==this.curDropDown&&(this.banId="",this.selectViolatesTheSixTitle=""),"是否违反员工不安全行为"==this.curDropDown&&(this.personId="",this.selectEmployeesUnsafeTitle=""),"是否违反承包商人员不安全行为"==this.curDropDown&&(this.cpersonId="",this.selectContractorEmployeesUnsafeTitle="")))})},clickDuty(e,t){let i=this.dutyOptions.filter(e=>0!=e.sub);this.dutyOptions[t].sub=0==e.sub?1:0;let o=this.dutyOptions.filter(e=>0!=e.sub);if(o.length<1){this.dutyOptions.forEach(e=>{e.val==i[0].val&&(e.sub=1)}),this.visible=!0;let e=setTimeout(()=>{this.visible=!1,clearTimeout(e)},3e3)}},mustDel(){},handleTime(e){this.show=!0,this.timeType="date",this.isRequiredTimePopup="要求完成时间"==e},handleTimeType(){this.timeType="date"==this.timeType?"time":"date"},confirm(e){this.show=!1;let t="",i="",o="";"time"!=this.timeType&&(t=e.toLocaleDateString().split("/")[0],i=e.toLocaleDateString().split("/")[1],o=e.toLocaleDateString().split("/")[2]),"date"==this.timeType?this.isRequiredTimePopup?(this.requiredTime=t+"年"+i+"月"+o+"日 "+(new Date).toLocaleTimeString().slice(2),console.log("cnm",e.toLocaleDateString().replace(/\//g,"-"),"sb",(new Date).toLocaleTimeString().replace(/\:/g,"-")),this.overTime=e.toLocaleDateString().replace(/\//g,"-")+" "+(new Date).toLocaleTimeString().slice(2).replace(/\:/g,"-"),console.log("this.overTime",this.overTime)):(this.curTimeText=t+"年"+i+"月"+o+"日",this.checkTime=e.toLocaleDateString().replace(/\//g,"-")):(this.requiredTime=this.requiredTime.slice(0,this.requiredTime.split(" ")[0].length)+" "+e+":00",this.overTime=this.overTime.slice(0,this.overTime.split(" ")[0].length)+" "+(e+":00").replace(/\:/g,"-"))},cancel(e){this.show=!1},showImg(e){console.log("showImg",e),Object(g["a"])([e])},handelBtn(e){this.showUpload=!1},handleResData(e,t){let i=[],o=null,s=null;switch(t){case"合同名称":o="agreementName",s="id";break;case"问题类型一":o="value",s="key";break;case"问题类型二":o="twoCategory",s="id";break;case"违反条例":o="confContent",s="id";break;case"属地单位":break;case"承包商责任":o="name",s="id";break;case"监理单位责任":o="name",s="id";break;case"属地单位责任":o="name",s="id";break;default:break}return e.forEach((e,t)=>{const a={text:e[o]?e[o]:e,value:e[s]?e[s]:t,agreementCode:e.agreementCode?e.agreementCode:"",agreementCategoryName:e.agreementCategoryName?e.agreementCategoryName:"",contractorName:e.contractorName?e.contractorName:"",oneCategory:e.oneCategory?e.oneCategory:"",programFileName:e.programFileName?e.programFileName:"",questionSize:e.questionSize?e.questionSize:"",score:e.score?e.score:""};i.push(a)}),i},getAllAgreement(){this.$getHttp(this.$baseUrl+"/CMS/agreement/getAllAgreement").then(e=>{console.log("getAllAgreement",e),200==e.status&&(this.contractName=this.handleResData(e.data.data,"合同名称"))}).catch(e=>{})},getValueByCode(){this.$getHttp(this.$baseUrl+"/CMS/selectConf/getValueByCode?code=QUESTION_ONE_CATEGORY").then(e=>{console.log("getValueByCode",e),200==e.status&&(this.problemOne=this.handleResData(e.data.data,"问题类型一"))}).catch(e=>{})},getQuestionConf(){this.$getHttp(this.$baseUrl+"/CMS/agreementquestioncheckconf/getQuestionConf").then(e=>{console.log("getQuestionConf",e),200==e.status&&(this.problemTwo=this.handleResData(e.data.data,"问题类型二"))}).catch(e=>{})},getCommitSafeCheckConf(){this.$getHttp(this.$baseUrl+"/CMS/agreementsafecheckconf/getCommitSafeCheckConf").then(e=>{console.log("getCommitSafeCheckConf",e),200==e.status&&(this.violationRules=this.handleResData(e.data.data,"违反条例"))}).catch(e=>{})},getGroupList(){this.$getHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/getGroupList").then(e=>{console.log("getGroupList",e),200==e.status&&(this.territorialUnit=this.handleResData(e.data.data,"属地单位"))}).catch(e=>{})},findAllProjectName(){this.projectName=[],this.$getHttp(`${this.$baseUrl}/OS-PM/version/${window.localStorage.getItem("versionId")}/bigOverhaulProjectPlan/findAllProjectName`).then(e=>{console.log("findAllProjectName",e),200==e.status&&e.data.forEach(e=>{for(let t in e){const i={text:e[t],value:t};this.projectName.push(i)}})}).catch(e=>{})},async getUserInfo(){let e=await this.$getHttp(this.$baseUrl+"/CMS/uams/getUserInfo");console.log("getUserInfo",e),this.userInfo=e.data},getToolData(){let e="";"选择是否违反六大禁令"==this.curDropDown?e="ban":"选择是否违反员工不安全行为"==this.curDropDown?e="person":"选择是否违反承包商人员不安全行为"==this.curDropDown&&(e="cperson"),console.log("sb"),this.$getHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/getToolData",{params:{type:e}}).then(e=>{console.log("sbban",e),200==e.status&&(this.banActionList=e.data.data)}).catch(e=>{})},getAllPersons(e){this.$getHttp(this.$baseUrl+"/CMS/contractoragreementperson/getAllPersons",{params:{agreementId:e}}).then(e=>{console.log("getAllPersons",e),200==e.status&&(this.contractorDuty=this.handleResData(e.data.data,"承包商责任"),console.log("this.contractorDuty",this.contractorDuty))}).catch(e=>{})},getQuestionManagementPerson(e){this.$getHttp(this.$baseUrl+"/CMS/contractoragreementperson/getQuestionManagementPerson",{params:{contractorName:e}}).then(e=>{console.log("getQuestionManagementPerson",e),200==e.status&&(this.supervisorUnitDuty=this.handleResData(e.data.data,"监理单位责任"))}).catch(e=>{})},getPersonList(e){this.$getHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/getPersonList",{params:{group:e}}).then(e=>{console.log("getPersonList",e),200==e.status&&(this.territoryUnitDuty=this.handleResData(e.data.data,"属地单位责任"))}).catch(e=>{})},reset(){this.pictureId=[],this.problemImg=[],this.curTimeText="",this.isRequiredTimePopup=!1,this.requiredTime="",this.checkTime="",this.overTime="",this.contractName=[],this.contractNameTitle=[],this.contractNameValue="",this.contractCode="",this.serviceType=[],this.serviceTypeTitle="",this.problemOne=[],this.problemOneTitle="",this.problemOneValue="",this.problemTwo=[],this.problemTwoTitle="",this.problemTwoValue="",this.detailedDes="",this.violationRules=[],this.violationRulesTitle="",this.violationRulesValue="",this.violationDocuments="",this.problemSizeClassification="",this.giveScore="",this.userInfo={},this.projectName=[],this.projectNameTitle="",this.projectNameValue="",this.projectCode="",this.supervisorUnitTitle="",this.supervisorUnitValue="",this.processOption=[],this.contractor="",this.territorialUnit=[],this.territorialUnitTitle="",this.territorialUnitValue="",this.problemClassTitle="",this.problemClassValue="",this.problemSpecialtyTitle="",this.problemSpecialtyValue="",this.description="",this.aBoss="",this.aGuardian="",this.bBoss="",this.bGuardian="",this.dutyOptions.forEach(e=>e.sub=0),this.contractorDuty=[],this.contractorDutyTitle="",this.contractorDutyValue="",this.contractorDutyCheckData=[],this.contractorDirector=[],this.contractorDirectorStr="",this.contractorDutyResult=[],this.supervisorUnitDuty=[],this.supervisorUnitDutyTitle="",this.supervisorUnitDutyValue="",this.supervisorUnitDutyCheckData=[],this.supervisoryDirector=[],this.supervisoryDirectorStr="",this.supervisorUnitDutyResult=[],this.territoryUnitDuty=[],this.territoryUnitDutyResult=[],this.territoryUnitDutyTitle="",this.territoryUnitDutyValue="",this.territoryUnitDutyCheckData=[],this.territorialDirector=[],this.territorialDirectorStr="",this.money="",this.completedOnSiteTitle="",this.completedOnSiteValue="",this.violatesTheSixTitle="",this.violatesTheSixValue="",this.selectViolatesTheSixTitle="",this.employeesUnsafeValue="",this.employeesUnsafeTitle="",this.selectEmployeesUnsafeTitle="",this.contractorEmployeesUnsafeValue="",this.contractorEmployeesUnsafeTitle="",this.selectContractorEmployeesUnsafeTitle="",this.banActionRadio=null,this.contractorEchoPersonID=[],this.supervisoryEchoPersonID=[],this.territorialEchoPersonID=[]},async init(e){this.reset(),this.curTimeText=(new Date).toLocaleDateString().replace(/\//g,"-"),this.checkTime=(new Date).toLocaleDateString().replace(/\//g,"-"),this.getAllAgreement(),this.getValueByCode(),this.getQuestionConf(),this.getCommitSafeCheckConf(),this.getGroupList(),this.findAllProjectName(),await this.getUserInfo(),e&&(console.log("草稿回显1",e),this.echoId=e.id,e.agreementName&&this.getAllPersons(e.agreement_id),this.contractNameTitle=e.agreementName,this.contractNameValue=e.agreement_id,this.contractCode=e.agreementCode,this.serviceTypeTitle=e.agreementCategory,this.problemOneTitle=e.oneCategory,this.problemTwoTitle=e.twoCategory,this.problemTwoValue=e.question_id,this.detailedDes=e.category_comment,this.violationRulesTitle=e.confContent,this.violationRulesValue=e.safe_id,this.violationDocuments=e.programFileName,this.problemSizeClassification=e.questionSize,this.giveScore=e.score,this.userInfo.userGroups[0].name=e.check_contractor,this.userInfo.name=e.check_user,this.curTimeText=e.checkTime,this.projectNameTitle=e.project_name,this.projectCode=e.project_code,e.supervisory_unit&&this.getQuestionManagementPerson(e.supervisory_unit),this.supervisorUnitTitle=e.supervisory_unit,this.contractor=e.contractor,e.territorial_unit&&this.getPersonList(e.territorial_unit),this.territorialUnitTitle=e.territorial_unit,this.problemSpecialtyTitle=e.question_major,e.file.forEach(e=>{this.pictureId.push(e.id),this.problemImg.push({imgName:e.fileName+"."+e.fileType,imgPath:this.$baseUrl+"/CMS/upload/"+e.filePath,id:e.id})}),this.description=e.question_content,this.aBoss=e.a_boss,this.aGuardian=e.a_guardian,this.bBoss=e.b_boss,this.bGuardian=e.b_guardian,this.dutyOptions[0].sub=e.contractor_director?1:0,this.dutyOptions[1].sub=e.supervisory_director?1:0,this.dutyOptions[2].sub=e.territorial_director?1:0,this.contractorDutyTitle=this.handleBackStr(e.contractor_director,"承包商责任"),this.contractorDirectorStr=e.contractor_director,this.supervisorUnitDutyTitle=this.handleBackStr(e.supervisory_director,"监理单位责任"),this.supervisoryDirectorStr=e.supervisory_director,this.territoryUnitDutyTitle=this.handleBackStr(e.territorial_director,"属地单位责任"),this.territorialDirectorStr=e.territorial_director,this.requiredTime=e.overTime,this.overTime=e.overTime,this.money=e.money,this.completedOnSiteTitle=e.is_finish,e.banId&&(this.violatesTheSixTitle="是",this.selectViolatesTheSixTitle=e.banId,this.banId=e.ban_id),e.personId&&(this.employeesUnsafeTitle="是",this.selectEmployeesUnsafeTitle=e.personId,this.personId=e.person_id),e.cpersonId&&(this.contractorEmployeesUnsafeTitle="是",this.selectContractorEmployeesUnsafeTitle=e.cpersonId,this.cpersonId=e.cperson_id))},handleBackStr(e,t){if(!e)return;let i="";return e.split(",").forEach(e=>{i=e.split(";")[1]+","+i,"承包商责任"==t&&(this.contractorEchoPersonID.push(Number(e.split(";")[0])),this.contractorDutyCheckData.push(e.split(";")[1]),this.contractorDirector.push({text:e.split(";")[1],value:e.split(";")[0]})),"监理单位责任"==t&&(this.supervisoryEchoPersonID.push(Number(e.split(";")[0])),this.supervisorUnitDutyCheckData.push(e.split(";")[1]),this.supervisoryDirector.push({text:e.split(";")[1],value:e.split(";")[0]})),"属地单位责任"==t&&(this.territorialEchoPersonID.push(Number(e.split(";")[0])),this.territoryUnitDutyCheckData.push(e.split(";")[1]),this.territorialDirector.push({text:e.split(";")[1],value:e.split(";")[0]}))}),i.slice(0,i.length-1)}},mounted(){}},f=b,y=(i("398a"),Object(u["a"])(f,d,m,!1,null,"629837a0",null)),T=y.exports,_={name:"ProblemManageIndex",components:{navBar:a["a"],problemManageScreen:p,problemManageAdd:T},data(){return{btnTextVisible:!1,show:!1,addShow:!1,draftList:[{agreementName:"2018-2022年独山子石化公司安全阀校验及维修框架2018-JD-XL-014"},{agreementName:""},{agreementName:"2018-2022年独山子石化公司安全阀校验及维修框架2018-JD-XL-014"},{agreementName:""}],problemList:[],screenSvg:i("4d5e"),extraUrgent:i("0d15"),urgent:i("6da5"),commonly:i("6bf6"),add:i("307e")}},methods:{toProblemMangeDetails(e){this.$router.push({name:"ProblemMangeDetails",query:{item:e}})},showAdd(){this.addShow=!0,this.$nextTick(()=>{this.$refs.problemManageAdd.init()})},showScreen(){this.show=!0},continueEditing(e){this.addShow=!0,this.$nextTick(()=>{this.$refs.problemManageAdd.init(e)})},clickCg(){},changeClose(e){if(!e)return this.show=!1,this.addShow=!1,this.getProblemList(),void this.getDraftList();let t=Object.keys(e).some(t=>e[t]);this.screenSvg=i(t?"87f8":"4d5e"),this.getProblemList(e),this.getDraftList(),this.show=!1},getDraftList(){this.$postHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/getQuestion",{state:"NOSUBMIT"}).then(e=>{console.log("getDraftList",e),200==e.data.code&&(this.draftList=e.data.data.question,console.log("this.draftList",this.draftList))}).catch(e=>{})},getProblemList(e){this.problemList=[],this.$postHttp(this.$baseUrl+"/CMS/agreementquestionmanagement/getQuestion",e||{}).then(e=>{console.log("getQuestion",e),200==e.data.code&&(this.problemList=e.data.data.question,console.log("this.problemList",this.problemList))}).catch(e=>{})},changeScroll(){let e=null;console.log("详情"),this.btnTextVisible=!0,window.clearTimeout(e),e=window.setTimeout(()=>{this.btnTextVisible=!1},101)}},mounted(){this.getProblemList(),this.getDraftList(),document.querySelector(".problem-mange-body")&&document.querySelector(".problem-mange-body").addEventListener("scroll",this.changeScroll)},beforeDestroy(){document.querySelector(".problem-mange-body")&&document.querySelector(".problem-mange-body").removeEventListener("scroll",this.changeScroll)}},D=_,w=(i("17e9"),Object(u["a"])(D,o,s,!1,null,"4028672c",null));t["default"]=w.exports},ea14:function(e,t,i){},ea61:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAoCAYAAABOzvzpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPQSURBVHgB7ZpLThtBEIbLxjwkkDIRLJAQ8iAhsYx3LBkvEY/gE9icAHICwwliToBzguEplsAJMCfwACsWSJMFEm/y/5MJcYxjz4y7jY35pFa35XZPV01Vd1e1Y6IQ27aNvr6+LJqGaOD5+dm5v7/fzmQyrigiLoo4ODgwIfwJmpZoIhaLWYlE4oSKFkUkRBGPj4+bmGBxbm5uXTSyt7f3vbe310YzLe3C7u5uYX9/35YWASUUUTZFAU27AIRfw5ufubu7W5YWgXVgFVWKz5YmiUkT+BPIPjw8pLEwOdJCuOY8PT0dYmHcmJ+fL0hEIlvAzs5OTt5IeDI7O+vE4/E0rG8F7pCViESyAPh7CpUNs38T4avnAkuwoYwMFuCShCS0BdD0UNlY9b+9tfDEF3oZrnCI7dGUkIRSwB+/Q7OwuLi4JW3CwsLCEap1nBFCKyGwC/inPB50tO/1UYE75GEJS9gl0kFPi4EtwD98tK3wxJ/bkT9XdbT6oNMsYQ5KDV0AgudgVjzmbqEOYlYuTHBD9QLJ1R7PDxRoYa4GXQHNHM4IP+r1DRILJEdGRmR4eHgpQF/BuUAcx8lhwuko21ItuPhimzscGxsz+vv7A/3m6uqKxWzUL1AwNDg4KKOjoxIUKME4Pz/Po5kRBWDnyU9OThph5nBzc+MpoRHKwuFKOFFMOiXqsIaGhkQHWhSA/djzQ1EE/NkYGBgQHWhTgAFURGtYzVc5FsfUgZ5RwdTUlJyenuYhwIxEh28+xbF0oU0BNNnp6WlxXdeSiPCtcxxdb997hmgG1ivtjJY1oJP4UIB0OR8KkC6n6xVQcxssl8uMvr4ypLy8vFR5pm8piGJXIYsFWbYQm2xPTEw41X1eFICOBjpmKTSKhR/IO4CHEMpioS5AxhJkLCSTyZccgecC+IKxfhkdCxRe3i9MoRchb/ns7My7S0igvYY6L92F6SviMy1gpV7Pnp4eL8vTaQSccz6OuL1u2orByPX1tXQazAYxk9UANw6f562u878eHARXYMzzSafAuXIRb6AAByX9khWGP+Tk91pgVvdEltcbFBcjnku0M7iy88r4+DjvMmp1YWabt8kb2BbdV2lxJDO/YgDuCiz/xLKd4Ap8QTXSZy7T+viuCMUcV35R917g4uJihslNbo3+9tjewf1fKPARC/b9UrXQlYS6HudhCdmZL1QKiokHUDlUiimtVw5NmYKW+O8xCOqg7cB6j2naQQdp6h8ilVA5qEwo6BOVUqEYLkhGVZbYkNcKcyo/8BYKQnlC+kUoJMzYub29/RlGyHr8Am9vxiIOdTe3AAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=chunk-61672c49.bb1a1e8c.js.map